---
title: 06.01-OS-操作系统引论
tags:
  - 操作系统
  - 课内学习
categories:
  - 操作系统
mathjax: true
abbrlink: 2543
date: 2019-12-20 17:19:38
---

<br>
## 操作系统的定义

操作系统（Operating System，简称OS）是配置在计算机硬件上的第一层软件，是对硬件系统的首次扩充。主要作用是管理硬件设备来提高利用率和吞吐量，同时为用户和应用系统提供易于使用的接口。
- 提高利用率：使系统中各设备的空闲时间尽可能短。
- 提高吞吐量：使单位时间内完成的业务更多。
- 提供易于使用的接口：即是方便使用计算机资源。例如没有操作系统，操纵计算机可能需要用户输入二进制代码，有了操作系统，用户可以点击图标，操作系统就会将其转换成二进制代码。

<br>
### 操作系统的目标

- 方便性：即对用户和应用程序提供易于使用的接口。
- 有效性：提高利用率和吞吐量。
- 可扩充性：计算机硬件和体系结构等都在不断发展中，OS需要有好的可扩充性来满足不断发展的需求。
- 开放性：为了使计算机的应用环境从单机转换成网络，OS需要满足相应的软硬件标准来实现设备的互联。

<br>
### 操作系统的作用

- 提供易于使用的接口，如Shell、图形界面等。
- 管理计算机所有的资源，负责计算机系统全部资源的分配、控制、调度和回收。
- 隐蔽硬件特性，如计算2\*3，某些机器的实现是使用加法器做2+2+2，而有的机器是乘法器实现2\*3。操作系统屏蔽这些细节，用户只需要输入2\*3就能完成。

<br>
## 未配置操作系统的计算机系统

- 人工操作：程序员把程序和数据通过穿孔的方式记录在纸带上，再启动机器读入纸带，运行完成并取走计算结果后，才允许下一个用户上机。缺点：
  - 用户独占整机：计算机上的资源为上机用户独占。
  - 设备空闲率高：用户装卡，卸卡等人工操作时，设备资源是空闲的。
- 脱机输入/输出（Off-Line I/O）：为了解决人机矛盾及CPU、I/O等设备之间速度的不匹配。它是先把纸带通过输入设备在外围机（与主机相比处于次要地位的计算机）的控制下输入到磁带上，当CPU需要这些信息时再从磁带上高速地调取。类似的，在输出时把信息输出到磁盘中，在外围机的控制下通过输出设备输出。也就是说主机直接对磁盘进行操作，输入输出和程序运行脱离。
  - 減少了CPU的空闲时间：主机不必依赖输入输出，可以从磁盘中读取数据。
  - 提升了I/O速度：主机读取信息不再是从卡片中读取，从磁盘读取速度较快。

<div align="center"><img src="http://blogfileqiniu.isjinhao.site/40683018-6777-42a0-ae90-90a136f75876" /></div>

<br>
## 批处理系统

为了提升计算机资源的利用率和提升计算机的吞吐量研发出了批操作系统。

**基础概念**

- 作业：程序+数据+作业说明书（系统根据说明书来对程序的运行进行控制）。
- 周转时间：从作业进入系统到作业完成退出系统所用的时间。
- 平均周转时间：同时参与系统运行的几个作业的周转时间的平均值。$T=\frac{1}{n}[\sum_{i=1}^NT_i]$
- 带权周转时间：作业的周转时间（$T$）和系统为它提供服务的时间（$T_S$）。$W=\frac{T}{T_s}$
- 平均带权周转时间：同时参与系统运行的几个作业的带权周转时间的平均值。$T=\frac{1}{n}[\sum_{i=1}^NW_i]$

<br>
### 单道批处理系统

设计一个常驻内存的程序（监督程序），操作员有选择地把若干作业合成一批，安装输入设备上，并启动监督程序，然后由监督程序自动控制这批作业运行，从而减少部分人工干预，有效地缩短了作业运行前的准备时间，相对的提高CPU的利用率。同一时刻只有一个硬件在运行。特点：自动性、顺序性、单道性。缺点：
- I/O的慢速与CPU 的高速不匹配，且输入时需要CPU等待。
- 用户交互性差。作业安装输入后，就不能再交互。

<div align="center"><img src="http://blogfileqiniu.isjinhao.site/5404ba6f-d320-4018-a0d1-5a289d94f674" /></div>

<br>
### 多道批处理系统

把一个以上的作业存放在主存中，并且同时处于运行状态，使这些作业共享处理机和外部设备等其它系统资源。对于一个单处理机系统来说，作业同时处于运行状态只是宏观的概念，其含义是指每个作业都已开始运行，但尚未完成。就微观而言，在任意特定时刻，处理机上运行的作业只有一个。特点：多道性、无序性、调度性。优缺点：
- 优点：资源利用率高、系统吞吐量大。
- 缺点：作业仍然要排队处理，所以平均周转时间长、无交互能力。
此时如何调度程序已经不是再用一张简单的流程图能说明了。下图只是说明处理器利用率高。

<div align="center"><img src="http://blogfileqiniu.isjinhao.site/3cf806a0-cc5d-40ca-9590-52b94be8a2c1" /></div>

<br>
### 举例证明资源利用率高和系统吞吐量大

设内存中有三道程序 A、B、C，它们的计算和I/O操作的时间如下表所示：
| 程序操作 |  A   |  B   |  C   |
| :------: | :--: | :--: | :--: |
|   计算   |  30  |  60  |  20  |
|   I/O    |  40  |  30  |  40  |
|   计算   |  10  |  10  |  20  |
- 单道

<div align="center"><img src="http://blogfileqiniu.isjinhao.site/ae55bc34-5c24-455e-8203-e7ca54ce1fc7" width="100%" /></div>
- 多道

<div align="center"><img src="http://blogfileqiniu.isjinhao.site/cbdd6ae8-1724-4643-b97e-6ce7e1742cb4" width="100%" /></div>

<br>
## 分时系统

批处理系统中，作业一旦提交就不能进行更改，所以人机交互性很差。为了满足人机交互的需求诞生分时系统。每一个用户通过一台终端与计算机相连，以交互式的命令使用系统，采用分享CPU的方法，由于CPU的速度比人在终端输入指令的时间快得多，所以用户感到自己独占了整个计算机系统。系统规定一个称之为“时间片”的时间单位，所有终端用户轮流享用一个时间片的CPU。需要解决的问题：
- 及时接受：所有终端用户输入的信息都要能够被及时的送到处理器上。所以主机会以很快的速度循环扫描各个终端。每个终端也要拥有缓存区来保存输入的信息。
- 及时处理：用户需要能对自己的作业及其允许及时地实施控制。所以所有的作业必须驻留在内存中，因此批作业系统不能被使用。它采用的方式是：作业直接进入内存。但每个用户只连续使用一个“时间片”的时间，对所有用户进行循环。这样每个用户都能及时地与自己的作业进行交互。

<div align="center"><img src="http://blogfileqiniu.isjinhao.site/98780fe2-3f17-4ec0-a295-b21276cad639" /></div>

<br>
### 分时系统与多道批处理系统的不同特性

- 多路性：允许多个用户共享一台计算机，提高资源利用率。
- 独立性：每个用户之间互不干扰，感觉就是一个人在独占一台计算机。
- 及时性：用户的请求能在很短的时间内得到回应。
- 交互性：用户可以通过终端和计算机进行及时交互。

<br>
## 实时系统

指系统能及时响应外部事件的请求，在规定的时间内完成对该事件的处理，并控制所有实时任务协调一致地运行。实时系统强调程序运行的时间，它需对接收到的某些信号做出及时地反应。大多数的实时系统是专用系统，如：工业（武器）控制系统、信息查询系统、多媒体系统、嵌入式系统等。最大的特点就是可靠性：系统必须高度可靠，因为任何可能的差错都可能带来灾难性后果，所以系统一般都有多级容错措施。
- 按是否周期执行分类：
  - 周期性实时任务：如外部设备周期性地发出状态信号给计算机使其状态能被实时感知。
  - 非周期性实时任务：提交给系统时需要指定开始截止时间和完成截止时间。
- 硬实时任务&软实时任务：
  - 硬实时任务（Hard Real-time Task）：截止时间到达时任务必须完成，比如武器控制系统。
  - 软实时任务（Soft Real-time Task）：截止时间到达时任务没有完成没有太大影响，比如多媒体系统。

<br>
## 进程和线程

- 进程：在系统中能独立运行并作为资源分配的基本单位。
- 线程：独立运行的基本单位，比进程更小，基本上不拥有系统资源。通常在一个进程中包含了若干个线程。

<br>
## 操作系统的基本特性

- 并发：宏观上是多个进程同时运行，微观上是每一时刻只有一道进程在执行。
- 共享：系统中的资源可供内存中多个并发执行的进程（线程）共同使用。有两种共享方式：
  - 互斥共享方式，如打印机；
  - 同时访问方式，如共享文件夹、网络资源。
- 虚拟：通过某种技术把一个物理实体变为若干个逻辑上的对应物。这样可以避免一个进程单独占用某个物理设备，一个物理设备被分配给多个进程便可以提升物理设备的使用率。
- 不确定性（异步性）：进程以人们不可预知的速度向前推进，即为进程的不确定性。这样的话很可能是先进入内存的作业后完成；而后进入内存的作业先完成。尽管如此，但只要有合理的进程同步方式且运行环境相同，作业经多次运行，都会获得完全相同的结果。因此，异步运行方式是允许的。

<br>
## 操作系统的结构


### 传统操作系统结构

- 无结构OS：
  - 关注功能的实现和获得高的效率操作系统是为数众多的一组过程的集合，各过程之间可以相互调用，在操作系统内部不存在任何结构。
  - 程序设计的技巧，只是如何编制紧凑的程序，以便于有效地利用内存。
  - 操作系统既庞大又杂乱，缺乏清晰的程序结构。
  - 程序错误很多，给调试工作带来很多困难；另一方面也使程序难以阅读和理解，增加了维护人员的负担。
- 模块化结构OS
  - 模块化程序设计技术，是最早（20世纪60年代）出现的一种程序设计技术。该技术是基于“分解”和“模块”原则来控制大型软件的复杂度的。
  - 将OS按其功能划分为若干个具有一定独立性和大小的模块。每个模块具有某方面的管理功能，并规定好各模块间的接口， 使各模块之间能通过该接口实现交互，然后再进一步将各模块细分为若干个具有一定管理功能的子模块。（会导致模块之间的依赖关系很重，OS结构不清晰）
  - 若子模块较大时，再进一步将它细分。

<div align="center"><img src="http://blogfileqiniu.isjinhao.site/3637ba18-bc51-4b80-ba93-7e2ac5780c21" /></div>
- 分层式结构OS：
  - 改进设计方式，使每一步设计都是建立在可靠的基础上一层一层地自底向上增添软件层，每一层都实现若干功能，最后总能构成一个能满足需要的OS。
  - 每一层都仅使用其底层所提供的功能和服务，这样可使系统的调试和验证都变得容易。
  - 一旦发现错误后，通常该错误只会局限于某一层，因为它与所有其高层的软件无关，而此层以下的各层软件，又都经过仔细的调试，bug修复较为容易。

<br>
### 客户/服务器结构

- 为了提高OS的灵活性和可扩充性而将OS划分为两部分。
- 一部分是用于提供各种服务的一组服务器（进程），所有这些服务器（进程）都运行在用户态。当有一用户进程（现在称为客户进程）要求读文件的一个盘块时，该进程便向文件服务器（进程）发出一个请求；当服务器完成了该客户的请求后，便给该客户回送一个响应。
- 另一部分是内核，用来处理客户和服务器之间的通信， 即由内核来接收客户的请求，再将该请求送至相应的服务器；同时它也接收服务器的应答， 并将此应答回送给请求客户。
- 此外，在内核中还应具有其它一些机构，用于实现与硬件紧密相关的和一些较基本的功能。

<br>
### 面向对象结构（20世纪80年代）

- 该技术是基于“抽象”和“隐蔽”原则来控制大型软件的复杂度的。所谓对象，是指在现实世界中具有相同属性、服从相同规则的一系列事物的抽象，而把其中的具体事物称为对象的实例。
- OS中的各类实体如进程、线程、消息、存储器等，都使用了对象这一概念，相应地，便有进程对象、线程对象、 存储器对象等。
  - 由于隐蔽了表示实体的数据和操作，因而可以改变对象的表示而不会影响其它部分， 从而可以方便地改变老的对象和增加新的对象。
  - 继承性。继承性是面向对象技术所具有的重要特性。继承性是指子对象可以继承父对象的属性，这样，在创建一个新的对象时， 便可减少大量的时空开销。
  - 正确性和可靠性。由于对象是构成操作系统的基本单元，可以独立地对它进行测试，这样，比较易于保证其正确性和可靠性，从而比较容易保证整个系统的正确性和可靠性。

<br>
### 微服务结构（20世纪90年代）

- 能有效支持多处理机，适用于分布式系统环境。
- 以微内核为操作系统核心，以客户/服务器为基础，采用了面向对象的程序设计方法。
  - 所谓微内核技术，是指精心设计的、能实现现代OS核心功能的小型内核，它与一般的OS（程序）不同， 它更小更精炼，它不仅运行在核心态，而且开机后常驻内存， 它不会因内存紧张而被换出内存。
  - 微内核并非是一个完整的OS， 而只是为构建通用OS提供一个重要基础。
  - 在微内核OS结构中，通常都采用了客户/服务器模式，因此OS的大部分功能和服务，都是由若干服务器来提供的， 如文件服务器、作业服务器和网络服务器等。
